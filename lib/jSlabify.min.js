/**! @preserve jQuery jSlabify plugin v2.6 MIT/GPL2 @gschoppe **/
!function(e){e.fn.jSlabify=function(t){var a={targetFont:!1,fontZoom:1,constrainHeight:!1,slabRatio:1,fixedHeight:!1,hCenter:!1,vCenter:!1,forceNewCharCount:!0,wrapAmpersand:!0,headerBreakpoint:null,viewportBreakpoint:null,noResizeEvent:!1,resizeThrottleTime:300,maxFontSize:999,postTweak:!0,minWordSpace:.4,maxWordSpace:3,maxLetterSpace:1.5,precision:3,minCharsPerLine:2};return e("body").addClass("slabified"),this.each(function(){t&&e.extend(a,t);var n=e(this),i=e("span.slabbedtext",n).length,r=null,s=null,l=String(e.trim(n.text())).replace(/\s{2,}/g," ").split(" "),o=[],h=[],p=a.targetFont,m=a.fontZoom,d=a.constrainHeight,c=a.slabRatio,g=a.fixedHeight,f=a.hCenter,u=a.vCenter,v=a.forceNewCharCount,x=a.headerBreakpoint,w=a.viewportBreakpoint,b=a.postTweak,y=a.minWordSpace,M=a.maxWordSpace,T=a.maxLetterSpace,z=a.precision,C=a.resizeThrottleTime,S=a.minCharsPerLine,F=null,L=e(window).width(),H=n.find("a:first").attr("href")||n.attr("href"),W=H?n.find("a:first").attr("title"):"";if(!(!i&&S&&l.join(" ").length<S)){if(i){var j=document.createElement("div");e(j).html(n.html());for(var D,k;D=j.querySelectorAll("span.slabbedtext")[0];){var A=e(D).text(),R=D.outerHTML;a.wrapAmpersand&&(A=A.replace(/&/g,'<span class="amp">&amp;</span>'),R=(R=R.replace(/<span class="amp">&amp;<\/span>/g,"&amp;")).replace(/&amp;/g,'<span class="amp">&amp;</span>'));var B=e(D)[0].previousSibling;B=B&&B.nodeValue?B.nodeValue.replace(/\s{2,}/g," ").trim():"",a.wrapAmpersand&&(B=B.replace(/&amp;/g,'<span class="amp">&amp;</span>')),k=(k=e(D)[0].nextSibling)&&k.nodeValue?k.nodeValue.replace(/\s{2,}/g," ").trim():"",""!=B&&(o.push({type:0,value:B}),h.push(B)),o.push({type:1,value:A,raw:R}),e(D).prevAll().remove(),e(D).remove()}""!=k&&(o.push({type:0,value:k}),h.push(k)),h=h.join(" "),e(j).remove()}var P=function(){var t=l.join(" "),a=(t.length,t.length>0?t:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-'\".,?!&");return divDef='<div style="display:none;font-size:1em;margin:0;padding:0;height:auto;line-height:'+n.css("line-height")+';border:0;white-space:nowrap;word-spacing:0;letter-spacing:0;">',dummy=e(divDef+a+"</div>").appendTo(n),emW=dummy.width(),emH=dummy.height(),ratio=0==emH?1:emW/emH,charRatio=ratio/a.length,dummy2=e(divDef+"&nbsp;</div>").appendTo(n),s=dummy2.width()/parseFloat(dummy2.css("font-size"),10),dummy.remove(),dummy2.remove(),[emW,emH,ratio,a.length,charRatio,s]},V=function(){function t(t,n){for(var i=0,r=[],s="",l="",o="",h=t;i<n.length;){for(l="";l.length<=h&&(s=l,l+=n[i]+" ",!(++i>=n.length)););s=e.trim(s),l=e.trim(l),h-s.length<l.length-h&&s.length>=Math.max(S||2)?(o=s,i--):o=l,remainingText=n.slice(i).join(" "),remainingText.length>0&&remainingText.length<h&&(newLineDiff=Math.max((remainingText.length,Math.abs(o.length-h))),oneLineDiff=Math.abs(o.length+remainingText.length+1-h),(oneLineDiff<newLineDiff||remainingText.length<Math.max(S,3))&&(o+=" "+remainingText,i=n.length)),o=e("<div></div>").text(o).html(),a.wrapAmpersand&&(o=o.replace(/&amp;/g,'<span class="amp">&amp;</span>')),o=e.trim(o),r.push('<span class="slabbedtext">'+o+"</span>")}return r}var C,F=n.width(),j=g?n.height():F/c;if(u?n.height(j):g||n.css("height","auto"),n.removeClass("slabbedtextdone slabbedtextinactive"),w&&w>L||x&&x>F)n.addClass("slabbedtextinactive");else{if(C=P(),v||void 0!=r){if(r=C[1],s=C[5],p){var D=C[4],k=Math.min(60,Math.floor(F/(r*D*m)));V=Math.round(C[3]/k)}else var A=C[3],R=C[2],B=F/j,V=Math.round(Math.sqrt(R/B)),k=Math.min(60,Math.max(Math.round(A/V),1));if(i){for(var E=(V=Math.max(V,o.length))-i,q=[],I=0;I<o.length;I++)if(o[I].type)q.push(o[I].raw);else{var N=String(e.trim(o[I].value));charPerLine=N.length/Math.max(Math.round(E*N.length/h.length),1),sectionWords=N.replace(/\s{2,}/g," ").split(" "),q=q.concat(t(charPerLine,sectionWords))}n.html(q.join(""))}else n.html(t(k,l).join(""));H&&n.wrapInner('<a href="'+H+'" '+(W?'title="'+W+'" ':"")+"/>")}else r=C[1];n.has("div.innerslabwrap").length>0||n.wrapInner('<div class="innerslabwrap" />');var Z=n.children("div.innerslabwrap");Z.css("font-size","1em"),e("span.slabbedtext",n).each(function(){var t,n,i=e(this),l=i.text(),o=l.split(" ").length>1,h=parseFloat(i.css("font-size"),10);if(b)if(o){i.css({"word-spacing":""+h*s*y-s*h+"px","letter-spacing":0});var p=l.split(" ").length-1;p<0&&(p=0)}else i.css("letter-spacing",0);i.css("font-size","1em"),t=i.width()>0?F/i.width():1,n=(Math.min(r*t,a.maxFontSize)/r).toFixed(z),i.css("font-size",n+"em")});var Q=1;if(d&&Z.height()>j&&(Q=(j/Z.height()).toFixed(z),Z.css("font-size",Q+"em")),b&&e("span.slabbedtext",n).each(function(){var t=e(this),a=t.text(),n=a.split(" ").length,i=F-t.width(),r=parseFloat(t.css("font-size"),10);if(n>1){(l=i/(n-1))<r*s*y?l=r*s*y:l>r*s*M&&(l=r*s*M),l-=r*s,t.css("word-spacing",l.toFixed(z)+"px"),i=F-t.width()}var l=i/a.length;l<0?l=0:l>r*s*T&&(l=r*s*T),t.css("letter-spacing",l.toFixed(z)+"px"),(F-t.width())/F>.1&&(t.css("letter-spacing",0),t.css("word-spacing",0))}),n.addClass("slabbedtextdone"),f&&Z.css("text-align","center"),d&&u){var G=((j-Z.height())/2).toFixed(z);Z.css("position","relative").css("top",G+"px")}}};V(),a.noResizeEvent||e(window).resize(function(){e(window).width()!=L&&(L=e(window).width(),clearTimeout(F),F=setTimeout(function(){V()},C))})}})}}(jQuery);